json_nuevo={

	'schedule': [{
		'closingTime': '111111',
		'closed': False,
		'openingTime': '1111111',
		'day': 'Domingo'
	}, {
		'day': 'Lunes',
		'closingTime': '11111111',
		'openingTime': '11111',
		'closed': False
	}, {
		'openingTime': '111111111111',
		'closingTime': '11111111111',
		'day': 'Martes',
		'closed': False
	}, {
		'closingTime': '',
		'openingTime': '111111111',
		'closed': False,
		'day': 'Miercoles'
	}],
	'categoryFilter': {
		'name': '',
		'id': ''
	},
	'typeCommerce': '',
	'geoPoint': {
		'latitude': 123.098980,
		'longitude': 123.98789790
	},
	'address': {
		'formattedAddress': '',
		'streetname': '',
		'streetnumber': '',
		'postalCode': '',
		'town': ''
	},
	'phone': '1111111111111111111111111',
	'name': '1111111111111111111111',
	'nameCommerce': '111111111111111111111111',
	'description': '',
	'score': '0'
}
json_firebase = {
	'imagesCommerce': {
		'mapIcon': 'https://backoffice.c6exvb10-totalplay1-s1-public.model-t.cc.commerce.ondemand.com',
		'logo192Wx192H': 'https://backoffice.c6exvb10-totalplay1-s1-public.model-t.cc.commerce.ondemand.com',
		'storeImages': 'https://backoffice.c6exvb10-totalplay1-s1-public.model-t.cc.commerce.ondemand.com'
	},
	'schedule': [{
		'closingTime': '2222222222222',
		'closed': True,
		'openingTime': '222222222222',
		'day': 'Domingo'
	}, {
		'day': 'Lunes',
		'closingTime': '22222222222222',
		'openingTime': '222222222222222',
		'closed': True
	}, {
		'openingTime': '2222222222222222',
		'closingTime': '2222222222222222',
		'day': 'Martes',
		'closed': True
	}, {
		'closingTime': '222222222222222',
		'openingTime': '2222222222222',
		'closed': True,
		'day': 'Miercoles'
	}, {
		'closed': True,
		'openingTime': '2222222222222',
		'day': 'Jueves',
		'closingTime': '22222222222222222'
	}, {
		'closingTime': '2222222222222222',
		'openingTime': '2222222222222222',
		'day': 'Viernes',
		'closed': True
	}, {
		'openingTime': '2222222222222222222222',
		'closingTime': '2222222222222222222222',
		'day': 'Sábado',
		'closed': True
	}],
	'categoryFilter': {
		'name': '',
		'id': ''
	},
	'typeCommerce': 'Restaurante',
	'geoPoint': {
		'latitude': 0.0,
		'longitude': 0.0
	},
	'address': {
		'formattedAddress': '',
		'streetname': 'Jardín Centenario ',
		'streetnumber': '2',
		'postalCode': '',
		'town': 'COYOACAN'
	},
	'phone': '',
	'name': '',
	'nameCommerce': '',
	'description': '',
	'score': '0'
}
product = {
    "availableForPickup": False,
    "averageRating": 0.0,
    "baseOptions": [],
    "categories": [
        {
            "code": "",
            "name": "",
            "url": ""
        },
        {
            "code": "",
            "name": "",
            "url": ""
        }
    ],
    "characteristics": "",
    "classifications": [
        {
            "code": "",
            "features": [
                {
                    "code": "",
                    "comparable": False,
                    "featureUnit": {
                        "name": "Minutos",
                        "symbol": "min",
                        "unitType": "310"
                    },
                    "featureValues": [
                        {
                            "value": "40"
                        }
                    ],
                    "name": "",
                    "range": False
                },
                {
                    "code":"",
                    "comparable": False,
                    "featureUnit": {
                        "name": "Minutos",
                        "symbol": "min",
                        "unitType": "310"
                    },
             "featureValues": [
                        {
                            "value": "30"
                        }
                    ],
                    "name": "",
                    "range": False
                }
            ],
            "name": "Tiempos"
        }
    ],
    "code": "",
    "configurable": False,
    "description": "",
    "galleryImages": [
        {
            "altText": "",
            "format": "zoom",
            "imageType": "PRIMARY",
            "originalImageCode": "",
            "url": ""
        },
        {
            "altText": "",
            "format": "product",
            "imageType": "PRIMARY",
            "originalImageCode": "",
            "url": ""
        },
        {
            "altText": "",
            "format": "thumbnail",
            "imageType": "PRIMARY",
            "originalImageCode": "",
            "url": ""
        },
        {
            "altText": "",
            "format": "superZoom",
            "galleryIndex": 0,
            "galleryQualifier": "",
            "imageType": "GALLERY",
            "url": ""
        },
    ],
    "images": [
        {
            "altText": "",
            "format": "product",
            "imageType": "PRIMARY",
            "originalImageCode": "",
            "url": ""
        }
    ],
    "manufacturer": "",
    "manufacturerName": "",
    "multimedia": {
        "img": "",
        "video": ""
    },
    "name": "",
    "numberOfReviews": 0,
    "offlineDate": "01/01/2020",
    "onlineDate": "01/01/2020",
    "potentialPromotions": [],
    "price": {
        "currencyIso": "MXN",
        "formattedValue": "$",
        "priceType": "BUY",
        "value": 0.0
    },
    "priceRange": {},
    "productReferences": [],
    "purchasable": False,
    "reviews": [],
    "sku": "",
    "stock": {
        "stockLevel": 0,
        "stockLevelStatus": ""
    },
    "summary": "",
    "url": "",
    "vendor": {
    "categoriesFood": [
            {
                "id": "",
                "name": ""
            },
            {
                "id": "",
                "name": ""
            }
        ],
        "code": "",
        "name": ""
    },
    "warranty": ""
}
my_product = {
    "availableForPickup": False,
    "averageRating": 1.1,
    "baseOptions": [],
    "multimedia": {
        "img": "123123213"
        #"video": ""
    },
    "images": [
            {
                "qwe" : "mdfj",
                #"altText": "qewe",
                "format": "product",
                #"imageType": "PRIMARY",
                "originalImageCode": "099213",
                "url": "lñfgjoijgfdoig"
            },
                {
                    "qwe" : "23",
                    #"altText": "qewe",
                    "format": "thumbail",
                    "imageType": "",
                    "originalImageCode": "987h",
                    "url": "asdads"
                }
        ],
    "vendor" : {
            "categoriesFood": [
                {
                    "id": "1233",
                    #"name": "dassadsad",
                    "asd" : "asd"
                },
                {
                    "id": "1234321",
                    "name": "sadasddas"
                },
                {
                    "id": "wqert",
                    "name": "6776yj"
                }
            ],
            "code": "123krj",
            #"name": "09ijkookj"
        } #ya esta
}
def firebase_function(nuevo, firebase):
    def assign(el_new, el_body):
         for x in el_new:
             if x in el_body and el_new[x] != "":
                 el_body[x] = el_new[x]
             elif x in el_body and el_new[x] == "":
                 continue
             else:
                 print(f"{x} is not in given body")
                 continue
         return el_body
    def case_schedule(schedule, schedule_fire):
		breakpoint()
        for x in schedule_fire:
            if isinstance(x, dict):
                pos_x = schedule_fire.index(x)
                try:
                    if schedule_fire[pos_x]['day'] == schedule[pos_x]['day']:
                        schedule_fire[pos_x] = assign(schedule[pos_x], schedule_fire[pos_x])
                    else:
                        continue
                except:
                    continue

            else:
                continue
        return schedule_fire
    for el_n in nuevo:
        if el_n in firebase:

            if isinstance(nuevo[el_n],list) and el_n == "schedule":
                firebase[el_n] = case_schedule(nuevo[el_n],firebase[el_n])
            if isinstance(nuevo[el_n],list) and nuevo[el_n] != []:
                my_p = firebase[el_n][0]
                for y in nuevo[el_n]:
                    if isinstance(y, dict):
                        firebase[el_n].append(assign(y, my_p))
                    else:
                        firebase[el_n][y] = nuevo[el_n][y]
            if isinstance(nuevo[el_n],dict):
                for el_n_1 in nuevo[el_n]:

                    if el_n_1 in firebase[el_n]:
                        if nuevo[el_n][el_n_1] == "schedule":
                            firebase[el_n][el_n_1] = case_schedule(nuevo[el_n], firebase[el_n])
                        elif isinstance(nuevo[el_n][el_n_1],dict):
                            firebase[el_n][el_n_1] = assign(nuevo[el_n][el_n_1],firebase[el_n][el_n_1])
                        elif nuevo[el_n][el_n_1] != "":
                            firebase[el_n][el_n_1] = nuevo[el_n][el_n_1]
                        elif nuevo[el_n][el_n_1] == "":
                            continue
                    else:
                        print(f"{el_n_1} not in body")
            elif nuevo[el_n] == "":
                continue
        else:
            print(f"{el_n} is not in given body")
    if "geopoint" in firebase:
        firebase["geoPoint"] = firestore.GeoPoint(firebase["geoPoint"]["latitude"], firebase["geoPoint"]["latitude"])
        return firebase
    else:
        return firebase
print(firebase_function(my_product, product))
