#Nuevo
nuevo = {
  "users": {
    "alanisawesome": {
      "date_of_birth": "1111111",
      "full_name": "",
      "nickname": "111111",
    },
    "gracehop": {
      "date_of_birth": "",
      "full_name": "111111",
      "nickname": ""
    },
    "qwerty" : "ddd"
  },
  "myquery" : ""

}
#Firebase
firebase = {
  "users": {
    "alanisawesome": {
      "date_of_birth": "ssssssssssss",
      "full_name": "sssssssssssss",
      "nickname": "ssssss"
    },
    "gracehop": {
      "date_of_birth": "ssssssssss",
      "full_name": "ssssssssss",
      "nickname": "ssssssssssssss"
    },
    "qwerty" : "qwerty"
  },
   "myquery" : "asdsad"
}
firebase1 = {
	'imagesCommerce': {
		'mapIcon': 'https://backoffice.c6exvb10-totalplay1-s1-public.model-t.cc.commerce.ondemand.com',
		'logo192Wx192H': 'https://backoffice.c6exvb10-totalplay1-s1-public.model-t.cc.commerce.ondemand.com',
		'storeImages': 'https://backoffice.c6exvb10-totalplay1-s1-public.model-t.cc.commerce.ondemand.com'
	},
	'schedule': [{
		'closingTime': '',
		'closed': True,
		'openingTime': '',
		'day': 'Domingo'
	}, {
		'day': 'Lunes',
		'closingTime': '',
		'openingTime': '',
		'closed': True
	}, {
		'openingTime': '',
		'closingTime': '',
		'day': 'Martes',
		'closed': True
	}, {
		'closingTime': '',
		'openingTime': '',
		'closed': True,
		'day': 'Miercoles'
	}, {
		'closed': True,
		'openingTime': '',
		'day': 'Jueves',
		'closingTime': ''
	}, {
		'closingTime': '',
		'openingTime': '',
		'day': 'Viernes',
		'closed': True
	}, {
		'openingTime': '',
		'closingTime': '',
		'day': 'Sábado',
		'closed': True
	}],
	'categoryFilter': {
		'name': '',
		'id': ''
	},
	'typeCommerce': 'Restaurante',
	'geoPoint': {
		'latitude': 0.0,
		'longitude': 0.0
	},
	'address': {
		'formattedAddress': '',
		'streetname': 'Jardín Centenario ',
		'streetnumber': '2',
		'postalCode': '',
		'town': 'COYOACAN'
	},
	'phone': '',
	'name': '',
	'nameCommerce': '',
	'description': '',
	'score': '0'
}
nuevo1 = {
	'imagesCommerce': {
		'mapIcon': '',
		'logo192Wx192H': '',
		'storeImages': ''
	},
	'schedule': [{
		'closingTime': '111111',
		'closed': True,
		'openingTime': '1111111',
		'day': 'Domingo'
	}, {
		'day': 'Lunes',
		'closingTime': '11111111',
		'openingTime': '11111',
		'closed': True
	}, {
		'openingTime': '111111111111',
		'closingTime': '11111111111',
		'day': 'Martes',
		'closed': True
	}, {
		'closingTime': '',
		'openingTime': '111111111',
		'closed': True,
		'day': 'Miercoles'
	}, {
		'closed': True,
		'openingTime': '',
		'day': 'Jueves',
		'closingTime': ''
	}, {
		'closingTime': '',
		'openingTime': '',
		'day': 'Viernes',
		'closed': True
	}, {
		'openingTime': '',
		'closingTime': '',
		'day': 'Sábado',
		'closed': True
	}],
	'categoryFilter': {
		'name': '',
		'id': ''
	},
	'typeCommerce': '',
	'geoPoint': {
		'latitude': 0.0,
		'longitude': 0.0
	},
	'address': {
		'formattedAddress': '',
		'streetname': '',
		'streetnumber': '',
		'postalCode': '',
		'town': ''
	},
	'phone': '1111111111111111111111111',
	'name': '1111111111111111111111',
	'nameCommerce': '111111111111111111111111',
	'description': '',
	'score': '0'
}

#prueba product
product = {
    "availableForPickup": False,
    "averageRating": 0.0,
    "baseOptions": [],
    "categories": [
        {
            "code": "",
            "name": "",
            "url": ""
        },
        {
            "code": "",
            "name": "",
            "url": ""
        }
    ],
    "characteristics": "",
    "classifications": [
        {
            "code": "",
            "features": [
                {
                    "code": "",
                    "comparable": False,
                    "featureUnit": {
                        "name": "Minutos",
                        "symbol": "min",
                        "unitType": "310"
                    },
                    "featureValues": [
                        {
                            "value": "40"
                        }
                    ],
                    "name": "",
                    "range": False
                },
                {
                    "code":"",
                    "comparable": False,
                    "featureUnit": {
                        "name": "Minutos",
                        "symbol": "min",
                        "unitType": "310"
                    },
           "featureValues": [
                        {
                            "value": "30"
                        }
                    ],
                    "name": "",
                    "range": False
                }
            ],
            "name": "Tiempos"
        }
    ],
    "code": "weeey",
    "configurable": False,
    "description": "",
    "galleryImages": [
        {
            "altText": "",
            "format": "zoom",
            "imageType": "PRIMARY",
            "originalImageCode": "",
            "url": ""
        },
        {
            "altText": "",
            "format": "product",
            "imageType": "PRIMARY",
            "originalImageCode": "",
            "url": ""
        },
        {
            "altText": "",
            "format": "thumbnail",
            "imageType": "PRIMARY",
            "originalImageCode": "",
            "url": ""
        },
        {
            "altText": "",
            "format": "superZoom",
            "galleryIndex": 0,
            "galleryQualifier": "",
            "imageType": "GALLERY",
            "url": ""
        },
    ],
    "images": [
        {
            "altText": "",
            "format": "product",
            "imageType": "PRIMARY",
            "originalImageCode": "",
            "url": ""
        }
    ],
    "manufacturer": "",
    "manufacturerName": "",
    "multimedia": {
        "img": "",
        "video": ""
    },
    "name": "",
    "numberOfReviews": 0,
    "offlineDate": "01/01/2020",
    "onlineDate": "01/01/2020",
    "potentialPromotions": [],
    "price": {
        "currencyIso": "MXN",
        "formattedValue": "$",
        "priceType": "BUY",
        "value": 0.0
    },
    "priceRange": {},
    "productReferences": [],
    "purchasable": False,
    "reviews": [],
    "sku": "",
    "stock": {
        "stockLevel": 0,
        "stockLevelStatus": ""
    },
    "summary": "",
    "url": "",
    "vendor": {
        "categoriesFood": [
            {
                "id": "",
                "name": ""
            },
            {
                "id": "",
                "name": ""
            }
        ],
        "code": "",
        "name": ""
    },
    "warranty": ""
}
my_product = {
    "availableForPickup": True,
    "averageRating": 10.0,
    "characteristics": "sadsadsadasd",
    "classifications": [
        {
            "code": "123123",
            "features": [
                {
                    "code": "asdasd",
                    "comparable": False,
                    "featureUnit": {
                        "name": "Minutos",
                        "symbol": "min",
                        "unitType": "310"
                    },
                    "featureValues": [
                        {
                            "value": "40"
                        }
                    ],
                    "name": "Yadza",
                    "range": True
                }]}],
    "code": "weeey",
    "configurable": True,
    "multimedia": {
        "img": "ipowerrteiurte",
        "video": "nmb,vfjklfdk"
    },
    "name": "oiqpr",
    "numberOfReviews": 67,
    "price": {
        "currencyIso": "MXN",
        "formattedValue": "$",
        "priceType": "BUY",
        "value": 0.0
    },
    "images": [
        {
            "altText": "123",
            "format": "thumbnail",
            "imageType": "PRIMARY",
            "originalImageCode": "asdasd",
            "url": "213123"
        },
        {
            "altText": "9809",
            "format": "product",
            "imageType": "PRIMARY",
            "originalImageCode": "qweqwe",
            "url": "21344"
        }
    ],
    "vendor": {
        "categoriesFood": [
            {
                #"id": "",
                "name": "sd",
                "sadds" : "2"
            },
            {
                #"id": "",
                "name": "8998"
            }
        ],
        "code": "12233",
        #"name": ""
    },
}

#print(assign(nuevo["users"]["alanisawesome"],firebase["users"]["alanisawesome"]))

def firebase_funct(nuevo, firebase):
    def filter_type(param):
        error_array["", 0, 0.0]
        if (isinstance(param, str) or isinstance(param, bool) or isinstance(param, int) or isinstance(param, float)) and param not in error_array:
            return 1
        elif isinstance(param, dict):
            return 2
        elif isinstance(param, list):
            return 3
        else:
            return 0
    def assign(el_new, el_body):
         for x in el_new:
             if x in el_body and el_new[x] != "":
                 el_body[x] = el_new[x]
             elif x in el_body and el_new[x] == "":
                 continue
             else:
                 print(f"{x} is not in given body")
                 continue
         return el_body
    #asigna listas con dicts dentro
    def assign_v2(lis, body_lis):
        ret_body = []
        for x in lis:

            if filter_type(x) == 2:
                ret_body.append(assign(x, body_lis[lis.index(x)]))

            elif validate == 1 and lis[x] != "":
                ret_body.append({x : lis[x]})
            elif validate == 2:
                ret_body.append({x : assign(lis[x], body_lis[x])})
            elif validate == 3 and lis[x] != []:
                ""

            else:
                continue


        return ret_body #no functional yet
    for el_n in nuevo:
        if el_n in firebase:
            validate = filter_type(nuevo[el_n])
            #si es un dict
            if validate == 2:
                for el_n_1 in nuevo[el_n]:
                    if el_n_1 in firebase[el_n]:
                        validate = filter_type(nuevo[el_n][el_n_1])
                        if validate == 2:
                            firebase[el_n][el_n_1] = assign(nuevo[el_n][el_n_1],firebase[el_n][el_n_1])
                        elif validate == 0:
                            continue
                        else:

                    else:
                        print(f"{el_n_1} not in body")
            #Si es un array
            #si es una lista y no esta vacia
            elif validate == 3 and nuevo[el_n] != []:
                #firebase[el_n] = assign_v2(nuevo[el_n], firebase[el_n])
                ""
            elif nuevo[el_n] != "" or nuevo[el_n] != []:
                firebase[el_n] = nuevo[el_n]

            elif nuevo[el_n] == "" or nuevo[el_n] == []:
                continue

        else:
            print(f"{el_n} is not in given body")
    return firebase
#print(firebase_funct(nuevo1, firebase1))
#print(firebase_funct(my_product, product))




b = {
"openingHours": {
    "code": "",
    "specialDayOpeningList": [],
    "weekDayOpeningList": [
        {
            "closingTime": {
                "formattedHour": "",
                "hour": 0,
                "minute": 0
            },
            "openingTime": {
                "formattedHour": "",
                "hour": 0,
                "minute": 0
            },
            "closed": False,
            "weekDay": "dom."
        },
        {
            "closingTime": {
                "formattedHour": "",
                "hour": 0,
                "minute": 0
            },
            "openingTime": {
                "formattedHour": "",
                "hour": 0,
                "minute": 0
            },
            "closed": False,
            "weekDay": "lun."
        },
        {
            "closingTime": {
                "formattedHour": "",
                "hour": 0,
                "minute": 0
            },
            "openingTime": {
                "formattedHour": "",
                "hour": 0,
                "minute": 0
            },
            "closed": False,
            "weekDay": "mar."
        },
        {
            "closingTime": {
                "formattedHour": "",
                "hour": 0,
                "minute": 0
            },
            "openingTime": {
                "formattedHour": "",
                "hour": 0,
                "minute": 0
            },
            "closed": False,
            "weekDay": "mié."
        },
        {
            "closingTime": {
                "formattedHour": "",
                "hour": 0,
                "minute": 0
            },
            "openingTime": {
                "formattedHour": "",
                "hour": 0,
                "minute": 0
            },
            "closed": False,
            "weekDay": "jue."
        },
        {
            "closingTime": {
                "formattedHour": "",
                "hour": 0,
                "minute": 0
            },
            "openingTime": {
                "formattedHour": "",
                "hour": 0,
                "minute": 0
            },
            "closed": False,
            "weekDay": "vie."
        },
        {
            "closingTime": {
                "formattedHour": "",
                "hour": 0,
                "minute": 0
            },
            "openingTime": {
                "formattedHour": "",
                "hour": 0,
                "minute": 0
            },
            "closed": False,
            "weekDay": "sáb."
        }
    ]
},
}

my_b = {
"openingHours": {
    "code": "",
    "specialDayOpeningList": [],
    "weekDayOpeningList": [
        {
            "closingTime": {
                "formattedHour": "3453453",
                "hour": 435,
                "minute": 345
            },
            "openingTime": {
                "formattedHour": "546546",
                "hour": 65,
                "minute": 123
            },
            "closed": true,
            "weekDay": "Lunes"
        }


    ]
},
    }



def case_list_one_dict(list_body, body):
    for x in list_body:
        if x in body:
            validate = filter_type(list_body[x])
            #si el tipo en x es una lista
            if validate == 3:
                for y in list_body[x]:
                    validate1 = filter_type(list_body)
                    if validate1 == 2:
                        body[x][y] = case_dict(list_body[x][y, body[x][y]])#Haces los dicts
                    else:
                        validate1 = filter_type(list_body[x][y])
                        if validate1 == 1:
                            body[x][y] = list_body[x][y]
                        elif validate == 0:
                            continue
                        #subnivel
                        else:
                            body[x][y] = list_body[x][y]

        else:
            print(f"{x} is not in given body")
